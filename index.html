 
<!DOCTYPE html>
<html>
<head>
    <title>Inverter Monitoring Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background-color: #121212;
            color: #ffffff;
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: #00ffe1;
        }

        #duty-cycle {
            font-size: 1.5em;
            color: #ffdd57;
            text-align: center;
            margin-top: 10px;
        }

        canvas {
	    width: 900px;
            max-width: 90%;
	    height: 2000px;
	    max-height: 90%;
            margin: 40px auto;
            display: block;
            background-color: #1e1e1e;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 10px;
        }

	button {
	    background-color: #00ffe1;
	    color: #121212;
	    border: none;
	    padding: 10px 20px;
	    margin: 5px;
	    font-size: 1em;
	    border-radius: 5px;
	    cursor: pointer;
	    transition: background-color 0.3s ease;
	}
	
	button:hover {
	    background-color: #00ccbb;
	}
    </style>
	
</head>
<body>
    <h1> Inverter Monitoring Dashboard</h1>
    <div id="duty-cycle">Duty Cycle: --%</div>
    <div style="text-align: center; margin-top: 20px;">
	<button onclick="refreshData()"> Refresh Now</button>
	<button onclick="toggleCharts()"> Toggle Charts</button>
    <div>
    <canvas id="inputChart"></canvas>
    <canvas id="outputChart"></canvas>

    <script>
        const inputCtx = document.getElementById('inputChart').getContext('2d');
        const outputCtx = document.getElementById('outputChart').getContext('2d');

        const inputChart = new Chart(inputCtx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [
                    {
                        label: 'Input Voltage (V)',
                        data: [],
                        borderColor: '#00bfff',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.3
                    },
                    {
                        label: 'Input Current (A)',
                        data: [],
                        borderColor: '#ff6384',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.3
                    }
                ]
            },
            options: {
                plugins: {
                    legend: { labels: { color: '#fff' } }
                },
                scales: {
                    x: { ticks: { color: '#ccc' }, title: { display: true, text: 'Time', color: '#ccc' }},
                    y: { ticks: { color: '#ccc' }, title: { display: true, text: 'Input Values', color: '#ccc' }}
                }
            }
        });

        const outputChart = new Chart(outputCtx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [
                    {
                        label: 'Output Voltage (V)',
                        data: [],
                        borderColor: '#00ff7f',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.3
                    },
                    {
                        label: 'Output Current (A)',
                        data: [],
                        borderColor: '#ffa500',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.3
                    }
                ]
            },
            options: {
                plugins: {
                    legend: { labels: { color: '#fff' } }
                },
                scales: {
                    x: { ticks: { color: '#ccc' }, title: { display: true, text: 'Time', color: '#ccc' }},
                    y: { ticks: { color: '#ccc' }, title: { display: true, text: 'Output Values', color: '#ccc' }}
                }
            }
        });

        async function fetchData() {
            try {
                const response = await fetch('data.json');
                const data = await response.json();

                const timestamps = data.map(e => e.timestamp);
                const vin = data.map(e => parseFloat(e.vin));
                const iin = data.map(e => parseFloat(e.iin));
                const vout = data.map(e => parseFloat(e.vout));
                const iout = data.map(e => parseFloat(e.iout));
                const duty = data[data.length - 1].duty;

                document.getElementById("duty-cycle").innerText = `Duty Cycle: ${duty}%`;

                inputChart.data.labels = timestamps;
                inputChart.data.datasets[0].data = vin;
                inputChart.data.datasets[1].data = iin;
                inputChart.update();

                outputChart.data.labels = timestamps;
                outputChart.data.datasets[0].data = vout;
                outputChart.data.datasets[1].data = iout;
                outputChart.update();
            } catch (err) {
                console.error("Error fetching or parsing data:", err);
            }
        }
	function refreshData() {
	    fetchData();
	}
	let chartsVisible= true;
	function toggleCharts(){
	    chartsVisible = !chartsVisible;
	    document.getElementById('inputChart').style.display = chartsVisible ? 'block' : 'none';
	    document.getElementById('outputChart').style.display = chartsVisible ? 'block' : 'none';
	}	
        fetchData();
        setInterval(fetchData, 3000); // Update every 3 seconds
    </script>
</body>
</html>
